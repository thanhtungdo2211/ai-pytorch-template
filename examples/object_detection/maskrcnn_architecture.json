{
  "model": "MaskRCNN",
  "description": "Mask R-CNN with ResNet50 backbone and FPN",
  "components": {
    "transform": {
      "type": "GeneralizedRCNNTransform",
      "normalize": {
        "mean": [0.485, 0.456, 0.406],
        "std": [0.229, 0.224, 0.225]
      },
      "resize": {
        "min_size": 800,
        "max_size": 1333,
        "mode": "bilinear"
      }
    },
    "backbone": {
      "type": "BackboneWithFPN",
      "body": {
        "type": "ResNet50",
        "layers": {
          "conv1": {
            "type": "Conv2d",
            "in_channels": 3,
            "out_channels": 64,
            "kernel_size": 7,
            "stride": 2,
            "padding": 3,
            "bias": false
          },
          "bn1": {
            "type": "FrozenBatchNorm2d",
            "num_features": 64
          },
          "relu": {
            "type": "ReLU",
            "inplace": true
          },
          "maxpool": {
            "type": "MaxPool2d",
            "kernel_size": 3,
            "stride": 2,
            "padding": 1
          },
          "layer1": {
            "type": "Sequential",
            "blocks": 3,
            "bottleneck": {
              "in_channels": 64,
              "out_channels": 256,
              "expansion": 4
            }
          },
          "layer2": {
            "type": "Sequential",
            "blocks": 4,
            "bottleneck": {
              "in_channels": 128,
              "out_channels": 512,
              "stride": 2,
              "expansion": 4
            }
          },
          "layer3": {
            "type": "Sequential",
            "blocks": 6,
            "bottleneck": {
              "in_channels": 256,
              "out_channels": 1024,
              "stride": 2,
              "expansion": 4
            }
          },
          "layer4": {
            "type": "Sequential",
            "blocks": 3,
            "bottleneck": {
              "in_channels": 512,
              "out_channels": 2048,
              "stride": 2,
              "expansion": 4
            }
          }
        }
      },
      "fpn": {
        "type": "FeaturePyramidNetwork",
        "in_channels_list": [256, 512, 1024, 2048],
        "out_channels": 256,
        "inner_blocks": {
          "block0": {
            "type": "Conv2dNormActivation",
            "in_channels": 256,
            "out_channels": 256,
            "kernel_size": 1
          },
          "block1": {
            "type": "Conv2dNormActivation",
            "in_channels": 512,
            "out_channels": 256,
            "kernel_size": 1
          },
          "block2": {
            "type": "Conv2dNormActivation",
            "in_channels": 1024,
            "out_channels": 256,
            "kernel_size": 1
          },
          "block3": {
            "type": "Conv2dNormActivation",
            "in_channels": 2048,
            "out_channels": 256,
            "kernel_size": 1
          }
        },
        "layer_blocks": 4,
        "layer_block_config": {
          "type": "Conv2dNormActivation",
          "in_channels": 256,
          "out_channels": 256,
          "kernel_size": 3,
          "padding": 1
        },
        "extra_blocks": "LastLevelMaxPool"
      }
    },
    "rpn": {
      "type": "RegionProposalNetwork",
      "anchor_generator": {
        "type": "AnchorGenerator"
      },
      "head": {
        "type": "RPNHead",
        "conv": {
          "type": "Conv2dNormActivation",
          "in_channels": 256,
          "out_channels": 256,
          "kernel_size": 3,
          "padding": 1
        },
        "cls_logits": {
          "type": "Conv2d",
          "in_channels": 256,
          "out_channels": 3,
          "kernel_size": 1
        },
        "bbox_pred": {
          "type": "Conv2d",
          "in_channels": 256,
          "out_channels": 12,
          "kernel_size": 1
        }
      }
    },
    "roi_heads": {
      "type": "RoIHeads",
      "box_roi_pool": {
        "type": "MultiScaleRoIAlign",
        "featmap_names": ["0", "1", "2", "3"],
        "output_size": [7, 7],
        "sampling_ratio": 2
      },
      "box_head": {
        "type": "TwoMLPHead",
        "fc6": {
          "type": "Linear",
          "in_features": 12544,
          "out_features": 1024,
          "bias": true
        },
        "fc7": {
          "type": "Linear",
          "in_features": 1024,
          "out_features": 1024,
          "bias": true
        }
      },
      "box_predictor": {
        "type": "FastRCNNPredictor",
        "cls_score": {
          "type": "Linear",
          "in_features": 1024,
          "out_features": 2,
          "bias": true,
          "description": "Number of classes (person + background)"
        },
        "bbox_pred": {
          "type": "Linear",
          "in_features": 1024,
          "out_features": 8,
          "bias": true,
          "description": "Bounding box coordinates (4 per class * 2 classes)"
        }
      },
      "mask_roi_pool": {
        "type": "MultiScaleRoIAlign",
        "featmap_names": ["0", "1", "2", "3"],
        "output_size": [14, 14],
        "sampling_ratio": 2
      },
      "mask_head": {
        "type": "MaskRCNNHeads",
        "conv_layers": 4,
        "conv_config": {
          "type": "Conv2dNormActivation",
          "in_channels": 256,
          "out_channels": 256,
          "kernel_size": 3,
          "padding": 1
        }
      },
      "mask_predictor": {
        "type": "MaskRCNNPredictor",
        "conv5_mask": {
          "type": "ConvTranspose2d",
          "in_channels": 256,
          "out_channels": 256,
          "kernel_size": 2,
          "stride": 2
        },
        "relu": {
          "type": "ReLU",
          "inplace": true
        },
        "mask_fcn_logits": {
          "type": "Conv2d",
          "in_channels": 256,
          "out_channels": 2,
          "kernel_size": 1,
          "description": "Mask logits (2 classes: person + background)"
        }
      }
    }
  },
  "summary": {
    "backbone_type": "ResNet50 with FPN",
    "detector_type": "Faster R-CNN",
    "with_mask_branch": true,
    "num_classes": 2,
    "input_size": "variable (min 800, max 1333)",
    "main_components": [
      "Image Normalization & Resizing",
      "Feature Extraction (ResNet50 + FPN)",
      "Region Proposal Network (RPN)",
      "Region of Interest Pooling",
      "Object Classification & Bounding Box Regression",
      "Mask Prediction Branch"
    ]
  }
}
